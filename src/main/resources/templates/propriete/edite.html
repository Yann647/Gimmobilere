<!doctype html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}" >

<div layout:fragment="content">

    <div class="card" style="width: 48rem;">
        <div class="card-header">
            Modification d'une Propriété
        </div>
        <div class="card-body">
            <form th:action="@{/propriete/update}" th:method="POST" th:object="${propriete}" enctype="multipart/form-data">
                <input type="hidden" th:value="${propriete.id}" name="id">

                <div class="mb-3">
                    <label class="form-label">Adresse</label>
                    <input type="text" class="form-control" id="adresse" th:value="${propriete.adresse}" name="adresse" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Prix</label>
                    <input type="number" class="form-control" id="prix" th:value="${propriete.prix}" name="prix" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Type de propriete</label>
                    <select class="form-control" id="typePropriete" name="typePropriete" th:field="*{typePropriete}" required>
                        <option value="" disabled selected>Choisir un type</option>
                        <option th:each="typep : ${T(com.gestion.immobiliere.Gimmobilere.constant.TypePropriete).values()}"
                                th:value="${typep}"
                                th:text="${typep}"></option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-control" id="description" th:value="${propriete.description}" name="description" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Disponibilite</label>
                    <select class="form-control" id="disponible" name="disponible" th:field="*{disponible}" required>
                        <option value="" disabled selected>Choisir un type</option>
                        <option th:each="disponibl : ${T(com.gestion.immobiliere.Gimmobilere.constant.Disponible).values()}"
                                th:value="${disponibl}"
                                th:text="${disponibl}"></option>
                    </select>
                </div>

                <!-- Champ pour uploader une nouvelle image -->
                <div class="mb-3">
                    <label class="form-label">Nouvelle image (laisser vide pour conserver l'actuelle)</label>
                    <input type="file" class="form-control" id="image" name="image" accept="image/*">
                    <small class="form-text text-muted">Formats acceptés: JPG, PNG, GIF. Taille max: 10MB</small>
                </div>

                <!-- Affichage de l'image actuelle si elle existe -->
                <div class="mb-3" th:if="${propriete.imagePath != null and propriete.imagePath != ''}">
                    <label class="form-label">Image actuelle</label><br>
                    <img th:src="@{'/uploads/' + ${propriete.imagePath}}"
                         alt="Image actuelle"
                         style="max-width: 200px; max-height: 200px;"
                         class="img-thumbnail mb-2" />
                    <br>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="supprimerImage" name="supprimerImage" value="true">
                        <label class="form-check-label" for="supprimerImage">
                            Supprimer l'image actuelle
                        </label>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Terminer</button>
                <button type="reset" class="btn btn-secondary">Annuler</button>
            </form>
        </div>
    </div>

</div>
</html>
